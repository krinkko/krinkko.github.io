<!DOCTYPE html>
<html lang="de"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Braunschweig based sysadmin. Proud father of two and husband. I like hardcore punk, songwriters to rap. Open mind, open heart. LOVES bicycles &lt;3">
    <meta name="color-scheme" content="light dark">
    
    <link rel="shortcut icon" href="https://krinkko.github.io/favicon.ico">
    
    
    <link rel="stylesheet" href="/css/prism.css" />
    <script language="javascript" type="text/javascript"  src="/js/lazysizes.min.js"></script>
    <script language="javascript" type="text/javascript"  src="/js/prism.js"></script>

    <link rel="stylesheet" href="/css/style.min.css">

    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="HP Image Assistant Commandline Mit Powershell">
  <meta name="twitter:description" content="Nachdem ich mich nun den Vormittag mit der an sich tollen Idee der Remoteausführung von HP Image Assistant via Powershell auseinandergesetzt habe, hier mal meine 2ct dazu.
Ich hatte vor ein Script zu machen, welches mir erst einmal ausliest welche Treiber und Programme für ein bestimmtes Gerät verfügbar sind und welche Windows Update vielleicht nicht gesehen hat. Es gibt danach eine .html-Datei aus, in der die fehlenden oder aktualisierbaren Komponenten aufgelistet werden.">

    <meta property="og:url" content="https://krinkko.github.io/hp-image-assistant-commandline-mit-powershell/">
  <meta property="og:site_name" content="krinkko&#39;s">
  <meta property="og:title" content="HP Image Assistant Commandline Mit Powershell">
  <meta property="og:description" content="Nachdem ich mich nun den Vormittag mit der an sich tollen Idee der Remoteausführung von HP Image Assistant via Powershell auseinandergesetzt habe, hier mal meine 2ct dazu.
Ich hatte vor ein Script zu machen, welches mir erst einmal ausliest welche Treiber und Programme für ein bestimmtes Gerät verfügbar sind und welche Windows Update vielleicht nicht gesehen hat. Es gibt danach eine .html-Datei aus, in der die fehlenden oder aktualisierbaren Komponenten aufgelistet werden.">
  <meta property="og:locale" content="de_de">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-28T11:24:30+02:00">
    <meta property="article:modified_time" content="2024-08-28T11:24:30+02:00">
    <meta property="article:tag" content="Powershell">


    <title>HP Image Assistant Commandline Mit Powershell</title>
</head>
<body><header id="banner">
    <div class="headerauthor">
        <p class="headerauthor_pic">
            
            <img src="/images/123sawd.jpg">
        </p>
        <p class="headerauthor_desc"></p>
    </div>
    <h2><a href="https://krinkko.github.io/">krinkko&#39;s</a></h2>
    <nav>
        <ul>
            <li>
                <a href="/" title="posts">posts</a>
            </li><li>
                <a href="/about/" title="about">about</a>
            </li><li>
                <a href="/posts-archive/" title="archive">archive</a>
            </li>
        </ul>
    </nav>
    <p><small>Braunschweig based sysadmin. Proud father of two and husband. I like hardcore punk, songwriters to rap. Open mind, open heart. LOVES bicycles &lt;3</small></p>
    
</header>
<main id="content">
<article>
    <header id="post-header">
        <h1>HP Image Assistant Commandline Mit Powershell</h1><div>
                
                <time>28.08.2024</time>
                <ul>    
            
                <li><a href="https://krinkko.github.io/tags/powershell/">Powershell</a></li>
            
            </ul>
            
            </div></header><p>Nachdem ich mich nun den Vormittag mit der an sich tollen Idee der Remoteausführung von <a href="https://ftp.ext.hp.com/pub/caps-softpaq/cmit/HPIA.html">HP Image Assistant</a> via Powershell auseinandergesetzt habe, hier mal meine 2ct dazu.</p>
<p>Ich hatte vor ein Script zu machen, welches mir erst einmal ausliest welche Treiber und Programme für ein bestimmtes Gerät verfügbar sind und welche Windows Update vielleicht nicht gesehen hat. Es gibt danach eine .html-Datei aus, in der die fehlenden oder aktualisierbaren Komponenten aufgelistet werden.</p>
<p><b>Update 28.10.2024:</b> Die aktuelle Form des Scrips:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="k">param</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">bool</span><span class="p">]</span><span class="nv">$analyse</span> <span class="p">=</span> <span class="mf">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">bool</span><span class="p">]</span><span class="nv">$update</span> <span class="p">=</span> <span class="mf">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">bool</span><span class="p">]</span><span class="nv">$silent</span> <span class="p">=</span> <span class="mf">1</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Start-Transcript</span> <span class="n">-Path</span> <span class="s2">&#34;C:\hpia\logs\hpia-script.log&#34;</span> <span class="n">-Force</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Write-Log</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">param</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="no">string</span><span class="p">]</span><span class="nv">$Message</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="no">string</span><span class="p">]</span><span class="nv">$LogFile</span> <span class="p">=</span> <span class="s2">&#34;C:\HPIA\Logs\HPIA_analyze.log&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="no">string</span><span class="p">]</span><span class="nv">$LogLevel</span> <span class="p">=</span> <span class="s2">&#34;INFO&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c"># Ensure the log directory exists</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$logDir</span> <span class="p">=</span> <span class="p">[</span><span class="no">System.IO.Path</span><span class="p">]::</span><span class="n">GetDirectoryName</span><span class="p">(</span><span class="nv">$LogFile</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="n">-Path</span> <span class="nv">$logDir</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nb">New-Item</span> <span class="n">-ItemType</span> <span class="n">Directory</span> <span class="n">-Path</span> <span class="nv">$logDir</span> <span class="n">-Force</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c"># Create a timestamp</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$timestamp</span> <span class="p">=</span> <span class="nb">Get-Date</span> <span class="n">-Format</span> <span class="s2">&#34;yyyy-MM-dd HH:mm:ss&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c"># Format the log message</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$logMessage</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">$timestamp</span><span class="s2"> [</span><span class="nv">$LogLevel</span><span class="s2">] - </span><span class="nv">$Message</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c"># Write the log message to the log file</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Add-Content</span> <span class="n">-Path</span> <span class="nv">$LogFile</span> <span class="n">-Value</span> <span class="nv">$logMessage</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$logpath</span> <span class="p">=</span> <span class="s2">&#34;C:\HPIA\Logs\&#34;</span> <span class="c">#Oder Netzwerkpfad</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="n">-Path</span> <span class="n">D:</span><span class="p">\)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$downloadfolder</span> <span class="p">=</span> <span class="s2">&#34;D:\MEINPFAD\Treiber&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$downloadfolder</span> <span class="p">=</span> <span class="s2">&#34;C:\HPIA\Downloads\&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="n">-Path</span> <span class="s1">&#39;C:\HPIA\HP Image Assistant\HPImageAssistant.exe&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$assistantfilepath</span> <span class="p">=</span> <span class="s1">&#39;C:\HPIA\HP Image Assistant\HPImageAssistant.exe&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$assistantversion</span> <span class="p">=</span> <span class="s2">&#34;5.3.0.506&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$currentversion</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-Command</span> <span class="nv">$assistantfilepath</span><span class="p">).</span><span class="py">FileVersionInfo</span><span class="p">.</span><span class="py">FileVersion</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$currentversion</span> <span class="o">-lt</span> <span class="nv">$assistantversion</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="k">if</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="n">-Path</span> <span class="s2">&#34;NETWORKPATH\HP\hp-hpia-5.3.0.exe&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nb">Start-Process</span> <span class="s2">&#34;NETWORKPATH\HP\hp-hpia-5.3.0.exe&#34;</span> <span class="n">-ArgumentList</span> <span class="s2">&#34;/s /e /f </span><span class="se">`&#34;</span><span class="s2">C:\HPIA\HP Image Assistant</span><span class="se">`&#34;</span><span class="s2">&#34;</span> <span class="n">-wait</span>
</span></span><span class="line"><span class="cl">       <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="n">-Path</span> <span class="s2">&#34;NETWORKPATH\HP\hp-hpia-5.3.0.exe&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nb">Start-Process</span> <span class="s2">&#34;NETWORKPATH\HP\hp-hpia-5.3.0.exe&#34;</span> <span class="n">-ArgumentList</span> <span class="s2">&#34;/s /e /f </span><span class="se">`&#34;</span><span class="s2">C:\HPIA\HP Image Assistant</span><span class="se">`&#34;</span><span class="s2">&#34;</span> <span class="n">-wait</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="n">-Path</span> <span class="nv">$logpath</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$reportfolder</span> <span class="p">=</span> <span class="nb">new-item</span> <span class="n">-Path</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$logpath</span><span class="p">)</span><span class="s2">&#34;</span> <span class="n">-ItemType</span> <span class="n">Directory</span> <span class="n">-ErrorAction</span> <span class="k">Continue</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">catch</span> <span class="p">{</span> <span class="nb">Write-Host</span> <span class="s2">&#34;Error.&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$analyse</span> <span class="o">-eq</span> <span class="vm">$true</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$args</span> <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;/Operation:Analyze&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;/Silent&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;/AutoCleanup&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;/Action:List&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;/reportfolder:</span><span class="p">$(</span><span class="nv">$logpath</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Start-Process</span> <span class="s2">&#34;C:\HPIA\HP Image Assistant\HPImageAssistant.exe&#34;</span> <span class="n">-argumentlist</span> <span class="nv">$args</span> <span class="n">-wait</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$update</span> <span class="o">-eq</span> <span class="vm">$true</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$silent</span> <span class="o">-eq</span> <span class="vm">$true</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$args</span> <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;/Auto&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;/Category:All&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;/selection:all&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;/AutoCleanup&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;/Silent&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;/reportfolder:</span><span class="p">$(</span><span class="nv">$logpath</span><span class="p">)</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;/SoftpaqDownloadFolder:</span><span class="p">$(</span><span class="nv">$downloadfolder</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$args</span> <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;/Auto&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;/Category:All&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;/selection:all&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;/AutoCleanup&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;/Noninteractive&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;/reportfolder:</span><span class="p">$(</span><span class="nv">$logpath</span><span class="p">)</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;/SoftpaqDownloadFolder:</span><span class="p">$(</span><span class="nv">$downloadfolder</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$updateresult</span> <span class="p">=</span> <span class="nb">Start-Process</span> <span class="s2">&#34;C:\HPIA\HP Image Assistant\HPImageAssistant.exe&#34;</span> <span class="n">-argumentlist</span> <span class="nv">$args</span> <span class="n">-wait</span>
</span></span><span class="line"><span class="cl">        <span class="nb">write-log</span> <span class="n">-message</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$updateresult</span><span class="p">)</span><span class="s2">&#34;</span> <span class="n">-errorcode</span> <span class="s2">&#34;INFO&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$errorcode</span> <span class="p">=</span> <span class="nv">$_</span>
</span></span><span class="line"><span class="cl">		<span class="nb">Write-Log</span> <span class="n">-Message</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$errorcode</span><span class="p">)</span><span class="s2">&#34;</span> <span class="n">-errorcode</span> <span class="s2">&#34;ERROR&#34;</span> <span class="n">-LogFile</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$logpath</span><span class="p">)</span><span class="s2">\HPIA-analyze.log&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c"># Energiespareinstellungen normalisieren</span>
</span></span><span class="line"><span class="cl">        <span class="c">#Aktiviert wieder das Ausbalancierte Schema</span>
</span></span><span class="line"><span class="cl">        <span class="n">powercfg</span> <span class="p">/</span><span class="n">SETDCVALUEINDEX</span> <span class="n">SCHEME_CURRENT</span> <span class="n">2a737441</span><span class="p">-</span><span class="mf">1930</span><span class="p">-</span><span class="mf">4402</span><span class="p">-</span><span class="n">8d77-b2bebba308a3</span> <span class="n">48e6b7a6</span><span class="p">-</span><span class="n">50f5</span><span class="p">-</span><span class="mf">4782</span><span class="n">-a5d4</span><span class="p">-</span><span class="n">53bb8f07e226</span> <span class="mf">0</span> <span class="c"># Selective USB Energiesparen Batteriebetrieben</span>
</span></span><span class="line"><span class="cl">        <span class="n">powercfg</span> <span class="p">/</span><span class="n">SETACVALUEINDEX</span> <span class="n">SCHEME_CURRENT</span> <span class="n">2a737441</span><span class="p">-</span><span class="mf">1930</span><span class="p">-</span><span class="mf">4402</span><span class="p">-</span><span class="n">8d77-b2bebba308a3</span> <span class="n">48e6b7a6</span><span class="p">-</span><span class="n">50f5</span><span class="p">-</span><span class="mf">4782</span><span class="n">-a5d4</span><span class="p">-</span><span class="n">53bb8f07e226</span> <span class="mf">0</span> <span class="c"># Selective USB Energiesparen am Ladegerät</span>
</span></span><span class="line"><span class="cl">        <span class="n">powercfg</span> <span class="p">/</span><span class="n">change</span> <span class="nb">monitor-timeout</span><span class="n">-ac</span> <span class="mf">0</span>
</span></span><span class="line"><span class="cl">        <span class="n">powercfg</span> <span class="p">/</span><span class="n">change</span> <span class="nb">monitor-timeout</span><span class="n">-dc</span> <span class="mf">20</span>
</span></span><span class="line"><span class="cl">        <span class="n">powercfg</span> <span class="p">/</span><span class="n">change</span> <span class="nb">standby-timeout</span><span class="n">-dc</span> <span class="mf">60</span>
</span></span><span class="line"><span class="cl">        <span class="n">powercfg</span> <span class="p">/</span><span class="n">change</span> <span class="nb">standby-timeout</span><span class="n">-ac</span> <span class="mf">0</span>
</span></span><span class="line"><span class="cl">        <span class="n">powercfg</span> <span class="p">/</span><span class="n">S</span> <span class="n">SCHEME_CURRENT</span>
</span></span><span class="line"><span class="cl">        <span class="n">powercfg</span> <span class="p">/</span><span class="nb">h </span><span class="n">off</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="nv">$latest</span> <span class="p">=</span> <span class="nb">get-childitem</span> <span class="n">-path</span> <span class="n">C:</span><span class="p">\</span><span class="n">hpia</span><span class="p">\</span><span class="n">logs</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="py">Name</span> <span class="o">-Like</span> <span class="s2">&#34;*Readme*&#34;</span><span class="p">}</span> <span class="p">|</span> <span class="nb">Sort-Object</span> <span class="n">LastAccessTime</span> <span class="n">-Descending</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">-First</span> <span class="mf">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$mailadmin</span> <span class="p">=</span> <span class="s2">&#34;adminmail@bla.de&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$mailfrom</span> <span class="p">=</span> <span class="s2">&#34;noreply@bla.de&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$mailserver</span> <span class="p">=</span> <span class="s2">&#34;smtp.server.de&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$mailsubject</span> <span class="p">=</span> <span class="s2">&#34;HP Image Assistant Log for </span><span class="p">$(</span><span class="nv">$env:computername</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$mailbody</span> <span class="p">=</span> <span class="s2">&#34;See HP Image Assistant Log attached to this email.&#34;</span> 
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nb">Send-MailMessage</span> <span class="n">-BodyAsHtml</span> <span class="n">-body</span> <span class="nv">$mailbody</span> <span class="n">-To</span> <span class="nv">$mailadmin</span> <span class="n">-From</span> <span class="nv">$mailfrom</span> <span class="n">-Encoding</span> <span class="n">UTF8</span> <span class="n">-SmtpServer</span> <span class="nv">$mailserver</span> <span class="n">-Subject</span> <span class="nv">$mailsubject</span> <span class="n">-Attachments</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$latest</span><span class="p">.</span><span class="n">FullName</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$errorcode</span> <span class="p">=</span> <span class="nv">$_</span>
</span></span><span class="line"><span class="cl">            <span class="nb">write-host</span> <span class="s2">&#34;ERROR: </span><span class="nv">$errorcode</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>       
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Stop-Transcript</span>
</span></span></code></pre></div></article>
<section id="related-content">

<h3>Passend dazu?</h3>
<ul>
	
	<li><a href="/powershellscript-ohne-fenster/">Powershellscript ohne Fenster</a></li>
	
</ul>
</section>

        </main><footer id="footer">
    © 2024 d381blog

    <nav>
        <ul>
            <li>
                <a href="/impressum/" title="impressum">impressum</a>
            </li>
        </ul>
    </nav>
</footer>

<script defer language="javascript" type="text/javascript"  src="/js/lightbox2.js"></script></body>
</html>
